package com.monitor.config;

import lombok.extern.slf4j.Slf4j;
import org.springframework.boot.CommandLineRunner;
import org.springframework.http.HttpEntity;
import org.springframework.http.HttpHeaders;
import org.springframework.http.MediaType;
import org.springframework.http.client.SimpleClientHttpRequestFactory;
import org.springframework.stereotype.Component;
import org.springframework.web.client.RestTemplate;

import java.io.IOException;
import java.util.ArrayList;
import java.util.HashMap;
import java.util.List;
import java.util.Map;

/**
 * Jaspersoft Studio Controller
 *
 * @author dhy
 * @version 0.0.1
 * @date 2024年3月22日09:40:48
 */
@Component
@Slf4j
public class MonitorPrinterConfig implements CommandLineRunner {

//    public class MyRunnable implements Runnable {
//        @Override
//        public void run() {
//            // 异步执行的代码
//            printScheduledGet();
//        }
//    }

    @Override
    public void run(String... args) {
//        while (true) {
//            try {
//                for (int i = 0; i < 200; i++) {
//                    MyRunnable myRunnable = new MyRunnable();
//                    Thread thread = new Thread(myRunnable);
//                    thread.start();
//                }
//                Thread.sleep(1000);
//            } catch (Exception e) {
//                e.printStackTrace();
//                log.error("执行错误" + e.getMessage());
//            }
//        }

        while (true) {
            try {
                printScheduledPost();
                Thread.sleep(10000);
            } catch (Exception e) {
                e.printStackTrace();
                log.error("执行错误" + e.getMessage());
            }
        }
    }

    public void printScheduledGet() {
        try {
            log.info("打印程序心跳任务");
            SimpleClientHttpRequestFactory requestFactory = new SimpleClientHttpRequestFactory();
            requestFactory.setConnectTimeout(5000);
            requestFactory.setReadTimeout(5000);
            RestTemplate restTemplate = new RestTemplate(requestFactory);
            // get请求
//            String mapStr = "{\"C089\":\"/\",\"C088\":\"/\",\"C087\":\"/\",\"C086\":\"2\",\"C085\":\"SC6478ADK6.CNA2001\",\"C084\":\"QX\",\"C083\":\"/\",\"C082\":\"/\",\"C081\":\"/\",\"C080\":\"F202ICA3\",\"C099\":\"/\",\"C098\":\"/\",\"C097\":\"/\",\"C096\":\"/\",\"C095\":\"/\",\"C094\":\"?\",\"C093\":\"CNA2001\",\"C092\":\"*\",\"C091\":\"SC6478ADK6\",\"C090\":\"F1\",\"SHIFT\":\"1\",\"A508\":\"/\",\"A509\":\"/\",\"A506\":\"/\",\"A507\":\"/\",\"A504\":\"/\",\"A505\":\"/\",\"A502\":\"/\",\"A503\":\"/\",\"A500\":\"/\",\"A501\":\"/\",\"A519\":\"/\",\"A517\":\"/\",\"A518\":\"/\",\"A515\":\"/\",\"A516\":\"/\",\"A513\":\"/\",\"A514\":\"/\",\"A511\":\"/\",\"A512\":\"/\",\"A510\":\"/\",\"A528\":\"/\",\"A529\":\"/\",\"A526\":\"/\",\"A527\":\"/\",\"A524\":\"/\",\"A525\":\"/\",\"A522\":\"/\",\"A523\":\"/\",\"A520\":\"/\",\"A521\":\"/\",\"A539\":\"/\",\"A537\":\"/\",\"A538\":\"/\",\"A535\":\"/\",\"A536\":\"/\",\"A533\":\"/\",\"A534\":\"/\",\"A531\":\"/\",\"A532\":\"/\",\"A530\":\"/\",\"A308\":\"/\",\"A309\":\"/\",\"A306\":\"/\",\"A548\":\"/\",\"A307\":\"/\",\"A549\":\"/\",\"A304\":\"/\",\"A546\":\"/\",\"A305\":\"/\",\"A547\":\"/\",\"A302\":\"/\",\"A544\":\"/\",\"A303\":\"/\",\"A545\":\"/\",\"A300\":\"/\",\"A542\":\"/\",\"A301\":\"/\",\"A543\":\"/\",\"A540\":\"/\",\"A541\":\"/\",\"A319\":\"/\",\"A317\":\"/\",\"A559\":\"/\",\"A318\":\"/\",\"A315\":\"/\",\"A557\":\"/\",\"A316\":\"/\",\"A558\":\"/\",\"A313\":\"/\",\"A555\":\"/\",\"A314\":\"/\",\"A556\":\"/\",\"A311\":\"/\",\"A553\":\"/\",\"A312\":\"/\",\"A554\":\"/\",\"A551\":\"/\",\"A310\":\"/\",\"A552\":\"/\",\"A550\":\"/\",\"A328\":\"/\",\"A329\":\"/\",\"A326\":\"/\",\"A568\":\"/\",\"A327\":\"/\",\"A569\":\"/\",\"A324\":\"/\",\"A566\":\"/\",\"A325\":\"/\",\"A567\":\"/\",\"A322\":\"/\",\"A564\":\"/\",\"A323\":\"/\",\"A565\":\"/\",\"A320\":\"/\",\"A562\":\"/\",\"A321\":\"/\",\"A563\":\"/\",\"A560\":\"/\",\"A561\":\"/\",\"A339\":\"/\",\"A337\":\"/\",\"A579\":\"/\",\"A338\":\"/\",\"A335\":\"CJ71\",\"A577\":\"/\",\"A336\":\"/\",\"A578\":\"/\",\"A333\":\"/\",\"A575\":\"/\",\"A334\":\"/\",\"A576\":\"/\",\"A331\":\"/\",\"A573\":\"/\",\"A332\":\"/\",\"A574\":\"/\",\"A571\":\"/\",\"A330\":\"/\",\"A572\":\"/\",\"A570\":\"/\",\"A108\":\"CJ05\",\"A109\":\"/\",\"A106\":\"CJ81\",\"A348\":\"/\",\"A107\":\"/\",\"A349\":\"/\",\"A104\":\"CJ52\",\"A346\":\"/\",\"A588\":\"/\",\"PZ\":\"H02AA\",\"A105\":\"CJ81\",\"A347\":\"/\",\"A589\":\"/\",\"A102\":\"CJ71\",\"A344\":\"/\",\"A586\":\"/\",\"A103\":\"CJ53\",\"A345\":\"/\",\"A587\":\"/\",\"A100\":\"/\",\"A342\":\"/\",\"A584\":\"/\",\"A101\":\"/\",\"A343\":\"/\",\"A585\":\"/\",\"A340\":\"/\",\"A582\":\"/\",\"A341\":\"/\",\"A583\":\"/\",\"A580\":\"/\",\"A581\":\"/\",\"A119\":\"CJ04\",\"A117\":\"CJ34\",\"A359\":\"/\",\"A118\":\"CJ04\",\"A115\":\"/\",\"A357\":\"/\",\"A599\":\"/\",\"A116\":\"CJ34\",\"A358\":\"/\",\"A113\":\"CN04\",\"A355\":\"/\",\"A597\":\"/\",\"A114\":\"/\",\"A356\":\"/\",\"A598\":\"/\",\"A111\":\"CJ35\",\"A353\":\"/\",\"A595\":\"/\",\"A112\":\"CJ35\",\"A354\":\"/\",\"A596\":\"/\",\"A351\":\"/\",\"A593\":\"/\",\"A110\":\"/\",\"A352\":\"/\",\"A594\":\"/\",\"A591\":\"/\",\"A350\":\"/\",\"A592\":\"/\",\"A590\":\"/\",\"A128\":\"CJ01AA\",\"A129\":\"CJ34\",\"A126\":\"MK01\",\"A368\":\"/\",\"A127\":\"CJ01AA\",\"A369\":\"/\",\"A124\":\"CJ01AA\",\"A366\":\"/\",\"A125\":\"CJ01AA\",\"A367\":\"/\",\"A122\":\"CJ35\",\"A364\":\"/\",\"A123\":\"CJ35\",\"A365\":\"/\",\"A120\":\"CJ04\",\"A362\":\"/\",\"A121\":\"CJ04\",\"A363\":\"/\",\"A360\":\"/\",\"A361\":\"/\",\"A139\":\"CJ04\",\"A137\":\"CJ10\",\"A379\":\"/\",\"A138\":\"NE01\",\"A135\":\"/\",\"A377\":\"/\",\"A136\":\"CJ10\",\"A378\":\"/\",\"A133\":\"MK01\",\"A375\":\"/\",\"A134\":\"CJ03\",\"A376\":\"/\",\"A131\":\"CJ04\",\"A373\":\"/\",\"A132\":\"CJ04\",\"A374\":\"/\",\"A371\":\"/\",\"A130\":\"CJ34\",\"A372\":\"/\",\"A370\":\"/\",\"A148\":\"MK03\",\"A149\":\"BR01\",\"A146\":\"CJ05\",\"A388\":\"/\",\"A147\":\"CJ08\",\"A389\":\"/\",\"A144\":\"DC05\",\"A386\":\"/\",\"A145\":\"CJ03\",\"A387\":\"/\",\"A142\":\"CJ47\",\"A384\":\"/\",\"A143\":\"CW06\",\"A385\":\"/\",\"A140\":\"MK02AA\",\"A382\":\"/\",\"OPT\":\"CNA2001\",\"A141\":\"CJ01AA\",\"A383\":\"/\",\"A380\":\"/\",\"A381\":\"/\",\"PACKAGE\":\"?\",\"INTERIOR_COLOR\":\"\",\"A159\":\"53CJ05\",\"A157\":\"CJ81\",\"A399\":\"/\",\"A158\":\"/\",\"A155\":\"/\",\"A397\":\"/\",\"A156\":\"CJ81\",\"A398\":\"/\",\"A153\":\"DC01\",\"A395\":\"/\",\"A154\":\"CJ05\",\"A396\":\"/\",\"A151\":\"CJ34\",\"A393\":\"/\",\"A152\":\"MK03AA\",\"A394\":\"/\",\"A391\":\"/\",\"A150\":\"CJ35\",\"A392\":\"/\",\"A390\":\"/\",\"C108\":\"/\",\"C107\":\"/\",\"C106\":\"/\",\"C105\":\"/\",\"A168\":\"CH01\",\"C104\":\"/\",\"A169\":\"CH01\",\"C103\":\"/\",\"A166\":\"CJ14\",\"C102\":\"/\",\"A167\":\"MK07CJ01\",\"C101\":\"/\",\"A164\":\"H02AA\",\"C100\":\"/\",\"A165\":\"MK04CJ01\",\"A162\":\"CJ41AA\",\"A163\":\"/\",\"A160\":\"/\",\"A161\":\"/\",\"A179\":\"CH01\",\"A177\":\"DE01\",\"A178\":\"CJ101\",\"A175\":\"/\",\"A176\":\"/\",\"A173\":\"/\",\"A174\":\"CJ71\",\"A171\":\"CJ01\",\"A172\":\"/\",\"A170\":\"CJ02\",\"A188\":\"/\",\"A189\":\"CJ15\",\"A186\":\"CJ39\",\"A187\":\"NE30\",\"A184\":\"/\",\"A185\":\"/\",\"A182\":\"/\",\"A183\":\"/\",\"A180\":\"CW06\",\"A181\":\"CJ01\",\"A199\":\"CJ02\",\"A197\":\"/\",\"A198\":\"/\",\"A195\":\"/\",\"A196\":\"/\",\"A193\":\"/\",\"A194\":\"/\",\"A191\":\"CJ05\",\"A192\":\"/\",\"A190\":\"CJ52\",\"VIN\":\"LS4ASE2E9RA708079\",\"OPTIONALPACKAGE\":\"\",\"CGC\":\"/\",\"COLORNAME\":\"星辰白\",\"config\":\"H02AA\",\"COLOR\":\"WC7\",\"A609\":\"/\",\"A607\":\"/\",\"A608\":\"/\",\"A605\":\"/\",\"A606\":\"/\",\"A603\":\"/\",\"A604\":\"/\",\"A601\":\"/\",\"A602\":\"/\",\"A600\":\"/\",\"A618\":\"/\",\"A619\":\"/\",\"A616\":\"/\",\"A617\":\"/\",\"A614\":\"/\",\"A615\":\"/\",\"A612\":\"/\",\"A613\":\"/\",\"A610\":\"/\",\"A611\":\"/\",\"A629\":\"/\",\"A627\":\"/\",\"A628\":\"/\",\"A625\":\"/\",\"A626\":\"/\",\"A623\":\"/\",\"A624\":\"/\",\"A621\":\"/\",\"A622\":\"/\",\"A620\":\"/\",\"A638\":\"/\",\"A639\":\"/\",\"A636\":\"/\",\"A637\":\"/\",\"A634\":\"/\",\"A635\":\"/\",\"A632\":\"/\",\"A633\":\"/\",\"A630\":\"/\",\"A631\":\"/\",\"A409\":\"/\",\"A407\":\"/\",\"A649\":\"/\",\"A408\":\"/\",\"A405\":\"/\",\"A647\":\"/\",\"A406\":\"/\",\"A648\":\"/\",\"A403\":\"/\",\"A645\":\"/\",\"A404\":\"/\",\"A646\":\"/\",\"A401\":\"/\",\"A643\":\"/\",\"A402\":\"/\",\"A644\":\"/\",\"A641\":\"/\",\"A400\":\"/\",\"A642\":\"/\",\"A640\":\"/\",\"A418\":\"/\",\"A419\":\"/\",\"A416\":\"/\",\"A658\":\"/\",\"A417\":\"/\",\"A659\":\"/\",\"A414\":\"/\",\"A656\":\"/\",\"A415\":\"/\",\"A657\":\"/\",\"A412\":\"/\",\"A654\":\"/\",\"A413\":\"/\",\"A655\":\"/\",\"A410\":\"/\",\"A652\":\"/\",\"A411\":\"/\",\"A653\":\"/\",\"A650\":\"/\",\"A651\":\"/\",\"VCPA\":\"SC6478ADK6.CNA2001+?+WC7\",\"A429\":\"/\",\"A427\":\"/\",\"A669\":\"/\",\"A428\":\"/\",\"A425\":\"/\",\"A667\":\"/\",\"A426\":\"/\",\"A668\":\"/\",\"A423\":\"/\",\"A665\":\"/\",\"A424\":\"/\",\"A666\":\"/\",\"A421\":\"/\",\"A422\":\"/\",\"A664\":\"/\",\"A661\":\"/\",\"A420\":\"/\",\"A662\":\"/\",\"A660\":\"/\",\"A438\":\"/\",\"A439\":\"/\",\"A436\":\"/\",\"A678\":\"/\",\"A437\":\"/\",\"A679\":\"/\",\"A434\":\"/\",\"A676\":\"/\",\"A435\":\"/\",\"A677\":\"/\",\"A432\":\"/\",\"A674\":\"/\",\"A433\":\"/\",\"A675\":\"/\",\"A430\":\"/\",\"A672\":\"/\",\"TSN\":\"124026277\",\"A431\":\"/\",\"A673\":\"/\",\"A670\":\"/\",\"A671\":\"/\",\"A209\":\"/\",\"A207\":\"CJ14\",\"A449\":\"/\",\"A208\":\"BN03AA\",\"A205\":\"CJ01AA\",\"A447\":\"/\",\"A689\":\"/\",\"A206\":\"CJ01AA\",\"A448\":\"/\",\"A203\":\"CJ01\",\"A445\":\"/\",\"A687\":\"/\",\"A204\":\"CJ01\",\"A446\":\"/\",\"A688\":\"/\",\"A201\":\"/\",\"A443\":\"/\",\"A685\":\"/\",\"A202\":\"/\",\"A444\":\"/\",\"A686\":\"/\",\"A441\":\"/\",\"A683\":\"/\",\"A200\":\"/\",\"A442\":\"/\",\"A684\":\"/\",\"A681\":\"/\",\"A440\":\"/\",\"A682\":\"/\",\"A680\":\"/\",\"A218\":\"/\",\"A219\":\"CJ05\",\"A216\":\"CJ01\",\"A458\":\"/\",\"A217\":\"CJ02\",\"A459\":\"/\",\"A214\":\"/\",\"A456\":\"/\",\"A215\":\"/\",\"A457\":\"/\",\"A212\":\"CJ21\",\"A454\":\"/\",\"A696\":\"/\",\"A213\":\"CJ21\",\"A697\":\"/\",\"A210\":\"CJ21\",\"A452\":\"/\",\"A694\":\"/\",\"A211\":\"CJ21\",\"A453\":\"/\",\"A695\":\"/\",\"A450\":\"/\",\"A692\":\"/\",\"A451\":\"/\",\"A693\":\"/\",\"A690\":\"/\",\"A691\":\"/\",\"A229\":\"CJ02\",\"A227\":\"CJ06\",\"A469\":\"/\",\"A228\":\"/\",\"A225\":\"CJ06\",\"A467\":\"/\",\"A226\":\"CJ06\",\"A468\":\"/\",\"A223\":\"AW02AB\",\"A465\":\"/\",\"A224\":\"CJ06\",\"A466\":\"/\",\"A221\":\"MK05\",\"A463\":\"/\",\"A222\":\"/\",\"A464\":\"/\",\"A461\":\"/\",\"A220\":\"CJ05\",\"A462\":\"/\",\"A460\":\"/\",\"A238\":\"/\",\"A239\":\"/\",\"A236\":\"CJ05气\",\"A478\":\"/\",\"A237\":\"CJ03\",\"A479\":\"/\",\"A234\":\"CJ01\",\"A476\":\"/\",\"A235\":\"/\",\"A477\":\"/\",\"A232\":\"CW06\",\"A474\":\"/\",\"A233\":\"CJ01\",\"A475\":\"/\",\"A230\":\"CJ02\",\"A472\":\"/\",\"A231\":\"CJ02\",\"A473\":\"/\",\"A470\":\"/\",\"A471\":\"/\",\"A009\":\"CJ01\",\"A007\":\"CJ04\",\"A249\":\"/\",\"A008\":\"CJ02AA\",\"A005\":\"CJ01\",\"A247\":\"PT02\",\"A489\":\"/\",\"A006\":\"CJ03\",\"A248\":\"CJ25\",\"A003\":\"CJ09\",\"A245\":\"/\",\"A487\":\"/\",\"A004\":\"CJ01\",\"A246\":\"CJ03\",\"A488\":\"/\",\"A001\":\"CJ03\",\"A243\":\"CJ121\",\"A485\":\"/\",\"A002\":\"CJ05AC\",\"A244\":\"CJ121\",\"A486\":\"/\",\"A241\":\"CJ01\",\"A483\":\"/\",\"A242\":\"CJ02\",\"A484\":\"/\",\"A481\":\"/\",\"W001\":\"/\",\"A240\":\"/\",\"A482\":\"/\",\"W002\":\"/\",\"A480\":\"/\",\"A018\":\"CJ05\",\"A019\":\"/\",\"A016\":\"CJ01AA\",\"A258\":\"/\",\"A017\":\"CJ03AA\",\"A259\":\"/\",\"A014\":\"CJ01\",\"A256\":\"/\",\"A498\":\"/\",\"A015\":\"CJ01AA\",\"A257\":\"/\",\"A499\":\"/\",\"A012\":\"导航CJ01\",\"A254\":\"CJ10\",\"A496\":\"/\",\"A013\":\"DC03AA\",\"A255\":\"CJ01\",\"A497\":\"/\",\"A010\":\"CJ21\",\"A252\":\"MK02\",\"A494\":\"/\",\"A011\":\"CJ06\",\"A253\":\"MK02\",\"A495\":\"/\",\"A250\":\"/\",\"A492\":\"/\",\"A251\":\"/\",\"A493\":\"/\",\"A490\":\"/\",\"A491\":\"/\",\"A029\":\"CJ01AA\",\"A027\":\"CJ01\",\"A269\":\"/\",\"A028\":\"CJ150\",\"A025\":\"CJ01AA\",\"A267\":\"/\",\"A026\":\"/\",\"A268\":\"/\",\"A023\":\"CJ25\",\"A265\":\"MK05\",\"A024\":\"/\",\"A266\":\"CJ04\",\"A021\":\"导航CJ01\",\"A263\":\"CJ01\",\"A022\":\"/\",\"A264\":\"CJ102\",\"A261\":\"CJ53\",\"A020\":\"/\",\"A262\":\"/\",\"A260\":\"/\",\"A038\":\"CJ14\",\"A039\":\"/\",\"A036\":\"CJ35\",\"A278\":\"/\",\"A037\":\"CJ01AB\",\"A279\":\"CJ05\",\"A034\":\"CJ133\",\"A276\":\"/\",\"A035\":\"CJ133\",\"A277\":\"/\",\"A032\":\"CJ130\",\"A274\":\"CJ04\",\"A033\":\"CJ44\",\"A275\":\"/\",\"A030\":\"CJ34\",\"A272\":\"/\",\"A031\":\"CJ20\",\"A273\":\"CJ06\",\"A270\":\"CJ01\",\"A271\":\"CB01\",\"A049\":\"CJ34\",\"A047\":\"CJ03\",\"A289\":\"CJ01\",\"A048\":\"CJ03\",\"A045\":\"CJ03\",\"A287\":\"CJ05\",\"A046\":\"CJ03\",\"A288\":\"/\",\"A043\":\"CJ01\",\"A285\":\"CJ06\",\"A044\":\"CJ01\",\"A286\":\"CJ04\",\"A041\":\"CJ01AA\",\"A042\":\"/\",\"A284\":\"/\",\"A281\":\"CJ14\",\"A040\":\"CJ102AA\",\"A282\":\"/\",\"A280\":\"CJ05\",\"A058\":\"CJ02\",\"A059\":\"CJ02\",\"A056\":\"CJ02\",\"A298\":\"/\",\"A057\":\"CJ02\",\"A299\":\"/\",\"A054\":\"CJ04\",\"A296\":\"/\",\"A055\":\"CJ07\",\"A297\":\"/\",\"A052\":\"CJ07\",\"A294\":\"/\",\"A053\":\"CJ07\",\"A295\":\"/\",\"SORT_NUMBER\":\"26042532\",\"A050\":\"CJ34\",\"A292\":\"/\",\"A051\":\"CJ05\",\"A293\":\"CJ01\",\"A290\":\"CJ01\",\"A291\":\"/\",\"C009\":\"1\",\"C008\":\"/\",\"C007\":\"1\",\"C006\":\"A\",\"A069\":\"CJ51\",\"C005\":\"R\",\"C004\":\"ASE2E\",\"A067\":\"CJ51\",\"C003\":\"LS4\",\"A068\":\"CJ130\",\"C002\":\"0\",\"A065\":\"CJ39\",\"C001\":\"01\",\"A066\":\"BN02AA\",\"A063\":\"CJ01\",\"A064\":\"CJ35\",\"A061\":\"CJ02AA\",\"A062\":\"CJ01\",\"A060\":\"CJ02AA\",\"C019\":\"1\",\"MODELOPT\":\"SC6478ADK6.CNA2001\",\"C018\":\"0\",\"C017\":\"0\",\"C016\":\"CS\",\"C015\":\"N8\",\"A078\":\"NE05\",\"C014\":\"1\",\"A079\":\"CJ13\",\"C013\":\"/\",\"A076\":\"CJ62\",\"C012\":\"1\",\"A077\":\"CS\",\"C011\":\"/\",\"A074\":\"CJ01\",\"C010\":\"/\",\"A075\":\"/\",\"A072\":\"导航CJ01\",\"A073\":\"自动CJ03\",\"A070\":\"CJ02\",\"A071\":\"CJ07\",\"C029\":2,\"C028\":1720,\"C027\":1870,\"C026\":4745,\"A089\":\"CJ101\",\"C025\":\"JL473ZQ7\",\"C024\":\"1\",\"A087\":\"/\",\"C023\":\"/\",\"A088\":\"/\",\"C022\":\"B\",\"A085\":\"/\",\"C021\":\"1\",\"A086\":\"CJ01\",\"C020\":\"Y\",\"A083\":\"/\",\"A084\":\"CJ02\",\"A081\":\"CJ06\",\"A082\":\"/\",\"A080\":\"CJ06\",\"MODEL\":\"SC6478ADK6\",\"C039\":\"1494mL\",\"C038\":\"138kW\",\"C037\":\"2100kg\",\"C036\":\"有\",\"C035\":7,\"A098\":\"CJ130\",\"C034\":2100,\"A099\":\"CJ130\",\"C033\":1590,\"A096\":\"CJ101\",\"C032\":1590,\"A097\":\"CJ101\",\"C031\":4,\"A094\":\"CJ02\",\"C030\":2786,\"A095\":\"CJ82\",\"A092\":\"/\",\"A093\":\"CJ02\",\"A090\":\"CJ101\",\"A091\":\"YJ87\",\"C049\":\"SC6478ADK6.CNA2001\",\"C048\":\"/\",\"C047\":\"F202\",\"C046\":\"/\",\"C045\":\"/\",\"C044\":\"/\",\"C043\":\"1575kg\",\"C042\":\"133kW\",\"C041\":\"/\",\"C040\":7,\"C059\":\"/\",\"C058\":\"/\",\"C057\":\"/\",\"C056\":\"/\",\"DATE\":\"2024-03-22\",\"C055\":\"/\",\"C054\":\"/\",\"C053\":\"/\",\"C052\":1,\"C051\":34,\"C050\":\"KAC\",\"P007\":\"/\",\"P006\":\"/\",\"P001\":\"/\",\"P002\":\"/\",\"P008\":\"/\",\"C069\":\"/\",\"C068\":\"/\",\"C067\":\"/\",\"C066\":\"/\",\"C065\":\"/\",\"C064\":\"/\",\"C063\":\"/\",\"C062\":\"/\",\"C061\":\"DCT\",\"C060\":\"/\",\"carSeries\":\"F202\",\"C079\":\"/\",\"C078\":\"/\",\"C077\":\"/\",\"C076\":\"/\",\"C075\":\"225/55R19\",\"C074\":\"M1\",\"C073\":\"/\",\"C072\":\"/\",\"C071\":\"/\",\"C070\":\"/\"}";
            String mapStr = "";
            String printUrl = "http://127.0.0.1:8880/printer/startPrinter?map=" + mapStr + "&printerIp=AssemblyEng&copy=0&templateName=AssemblyEng";
            restTemplate.getForObject(printUrl, String.class);
            log.info("打印程序心跳正常");
        } catch (Exception e) {
            log.error("打印程序心跳异常执行重启操作===========");
            List<String> commands = new ArrayList<>();
            // 关闭所有javaw.exe进程
            commands.add("taskkill /F /IM javaw.exe");
            // 重启java程序
            commands.add("cmd /c start javaw -XX:ErrorFile=D:\\Printer\\log\\java_error.log -jar D:\\Printer\\printer-0.0.1-SNAPSHOT.jar");
            Process currentProcess = null;
            try {
                for (String command : commands) {
                    // 创建ProcessBuilder实例
                    ProcessBuilder processBuilder = new ProcessBuilder(command.split("\\s+"));
                    // 启动进程
                    currentProcess = processBuilder.start();
                    // 等待当前进程执行完成
                    int exitCode = currentProcess.waitFor();
                    log.info("命令已退出，返回代码" + exitCode);
                }
            } catch (IOException | InterruptedException ex) {
                ex.printStackTrace();
            } finally {
                // 确保当前进程被正确关闭
                if (currentProcess != null) {
                    currentProcess.destroy();
                }
            }
        }
    }

    public void printScheduledPost() {
        try {
            log.info("打印程序心跳任务");
            String url = "http://127.0.0.1:8880/printer/startPrinter";
            Map<String, Object> params = new HashMap<>();
            params.put("map", "");
            params.put("templateName", "heartbeat");
            params.put("printerIp", "heartbeat");
            params.put("copy", 0);
            HttpHeaders headers = new HttpHeaders();
            MediaType type = MediaType.parseMediaType("application/json; charset=UTF-8");
            headers.setContentType(type);
            HttpEntity<Map<String, Object>> httpEntity = new HttpEntity<>(params, headers);
            SimpleClientHttpRequestFactory requestFactory = new SimpleClientHttpRequestFactory();
            requestFactory.setConnectTimeout(5000);
            requestFactory.setReadTimeout(5000);
            RestTemplate restTemplate = new RestTemplate(requestFactory);
            restTemplate.postForObject(url, httpEntity, String.class);
            log.info("打印程序心跳正常");
        } catch (Exception e) {
            log.error("打印程序心跳异常执行重启操作===========");
            List<String> commands = new ArrayList<>();
            // 关闭所有javaw.exe进程
            commands.add("taskkill /F /IM javaw.exe");
            // 重启java程序
            commands.add("cmd /c start javaw -XX:ErrorFile=D:\\Printer\\log\\java_error.log -jar D:\\Printer\\new\\printer-post.jar");
            Process currentProcess = null;
            try {
                for (String command : commands) {
                    // 创建ProcessBuilder实例
                    ProcessBuilder processBuilder = new ProcessBuilder(command.split("\\s+"));
                    // 启动进程
                    currentProcess = processBuilder.start();
                    // 等待当前进程执行完成
                    int exitCode = currentProcess.waitFor();
                    log.info("命令已退出，返回代码" + exitCode);
                }
            } catch (IOException | InterruptedException ex) {
                ex.printStackTrace();
            } finally {
                // 确保当前进程被正确关闭
                if (currentProcess != null) {
                    currentProcess.destroy();
                }
            }
        }
    }
}
